# Pyramid Trend EA - Demo模式使用指南

## 🎯 什么是Demo模式？

**Demo模式**是一个**实时测试功能**，让您可以在真实的图表上观察策略信号，但**不会真实下单**。

### 适用场景

✅ **实时图表测试** - 在当前行情中观察策略表现  
✅ **参数调优** - 快速测试不同参数组合  
✅ **学习策略** - 理解策略的入场逻辑  
✅ **信号验证** - 确认策略在当前市场环境下的信号质量  

---

## 📋 使用步骤

### 步骤1: 启用Demo模式

1. **打开MT4图表**
   - 选择品种：EURUSD（或其他）
   - 选择周期：H1 或 H4（推荐）

2. **拖拽EA到图表**
   - 导航器 → EA交易 → `PyramidTrend_EA`
   - 拖到图表上

3. **在参数设置中启用Demo模式**
   ```
   === Basic Settings ===
   Demo Mode (Signal Only, No Real Orders): true ✓
   ```

4. **点击OK**

### 步骤2: 观察可视化效果

EA启动后，您会看到：

#### A. 图表右上角 - 实时状态标签

```
▲ UPTREND | ADX: 28.5 | Levels: 0/4
```

**含义**：
- `▲` - 当前趋势方向（▲上升 / ▼下降 / ● 减弱 / ○ 无趋势）
- `ADX: 28.5` - 趋势强度
- `Levels: 0/4` - 当前金字塔层数 / 最大层数（Demo模式下始终为0）

#### B. K线图上 - 趋势指示箭头

每根K线上显示：
```
🟢 ↑ UP(28)     - 上升趋势（ADX=28）
🔴 ↓ DOWN(32)   - 下降趋势（ADX=32）
🟠 ● WEAK(18)   - 趋势减弱（ADX=18）
```

#### C. K线图上 - 交易信号箭头

当出现入场信号时，显示**大号买卖箭头**：
```
🟢 ⬆ (大号上箭头) - 做多信号
🔴 ⬇ (大号下箭头) - 做空信号
```

### 步骤3: 查看Journal日志

打开**终端 → 专家**，查看详细信号：

```
[DEMO Signal] LONG | Price:1.09215 | Lots:0.10 | SL Distance:0.00150 | Risk:0.5%
[Strategy] Uptrend detected - EMA(21):1.09180 > EMA(50):1.09150 | ADX:28.5
```

**日志说明**：
- `[DEMO Signal]` - 入场信号
- `LONG/SHORT` - 方向
- `Price` - 入场价格
- `Lots` - 计算出的手数
- `SL Distance` - 止损距离
- `Risk` - 风险占比

---

## 🎨 可视化效果对照表

| 显示元素 | 颜色 | 含义 | 箭头代码 |
|---------|------|------|---------|
| UP(ADX) | 🟢 绿色 | 上升趋势 | 233 (小箭头上) |
| DOWN(ADX) | 🔴 红色 | 下降趋势 | 234 (小箭头下) |
| WEAK(ADX) | 🟠 橙色 | 趋势减弱 | 108 (圆点) |
| 买入信号 | 🟢 绿色 | 做多入场 | 241 (大箭头上) |
| 卖出信号 | 🔴 红色 | 做空入场 | 242 (大箭头下) |

---

## ⚙️ 调整参数测试

### 快速调整关键参数

**在EA属性中修改**（右键EA → 属性 → 输入参数）：

#### 1. 趋势识别参数
```
TrendMA_Fast: 21        → 改为 15（更敏感）或 30（更保守）
TrendMA_Slow: 50        → 改为 40（更敏感）或 60（更保守）
ADX_Threshold: 25.0     → 改为 20（更多信号）或 30（更严格）
```

#### 2. 风险参数
```
InitialRiskPercent: 0.5  → 改为 0.3（更保守）或 1.0（更激进，但需谨慎）
```

#### 3. 过滤器开关
```
EnableFilters: true/false           → 测试有无过滤器的差异
EnableWeekendFilter: true/false     → 测试周末过滤效果
EnableSpreadFilter: true/false      → 测试点差过滤效果
```

**修改后**：
- 点击 OK
- 观察图表上信号的变化
- 对比Journal日志

---

## 📊 实战测试流程

### 测试1: 观察趋势识别准确度

**目标**：验证策略能否正确识别趋势

1. 启用Demo模式
2. 观察图表上的趋势箭头
3. 对比真实价格走势：
   - ✅ 上升趋势时，价格确实在上涨
   - ✅ 下降趋势时，价格确实在下跌
   - ❌ 趋势识别滞后或误判

4. **调整**：如果趋势识别不准
   - 减小`TrendMA_Fast`（更敏感）
   - 降低`ADX_Threshold`（更宽松）

---

### 测试2: 验证入场信号时机

**目标**：确认信号是否出现在合适的位置

1. 观察**大号箭头**（买卖信号）出现位置
2. 检查：
   - ✅ 信号出现在趋势刚开始的早期阶段
   - ✅ 信号后价格确实朝预期方向移动
   - ❌ 信号出现在趋势末期（滞后）
   - ❌ 信号后价格反向（误判）

3. **调整**：如果信号滞后
   - 减小`TrendMA_Fast`和`TrendMA_Slow`
   - 降低`ADX_Threshold`

---

### 测试3: 评估信号频率

**目标**：确认信号数量是否合理

1. 观察1小时或1天内的信号数量
2. 评估：
   - ✅ 每天1-3个信号（H1/H4）→ 合理
   - ❌ 每天10+个信号 → 过于频繁（参数过敏感）
   - ❌ 几天没有信号 → 过于保守（参数过严格）

3. **调整**：
   - 太多信号：提高`ADX_Threshold`，增大MA周期
   - 太少信号：降低`ADX_Threshold`，减小MA周期

---

## 🆚 Demo模式 vs 回测模式

| 特性 | Demo模式 | 回测模式 |
|-----|---------|---------|
| **运行环境** | 实时图表 | 策略测试器 |
| **数据** | 实时行情 | 历史数据 |
| **速度** | 实时（1:1） | 可加速 |
| **下单** | ❌ 不下单 | ✓ 模拟下单 |
| **可视化** | ✓ 实时箭头+标签 | ✓ 可视化模式 |
| **适用** | 参数测试、实时观察 | 性能评估、统计分析 |

---

## 💡 使用建议

### ✅ 推荐做法

1. **先用Demo模式**实时观察1-2天，了解策略行为
2. **再用回测模式**测试历史数据（3-6个月），评估性能
3. **调整参数**基于两者结合的结果
4. **小资金实盘**验证（关闭Demo模式）

### ⚠️ 注意事项

1. **Demo模式不考虑滑点和手续费**
   - 真实交易会有成本，性能会略低

2. **不会生成金字塔加仓信号**
   - Demo模式只显示初始入场信号
   - 完整金字塔逻辑需要在回测或实盘中测试

3. **市场环境影响**
   - 不同时间段（亚洲/欧洲/美洲盘）信号质量可能不同
   - 重大新闻时段信号可能失真

---

## 🔍 常见问题

### Q1: 为什么图表上没有显示箭头？

**可能原因**：
1. 当前没有明确趋势（ADX太低）
2. 参数过于严格，识别不到趋势
3. 对象绘制失败

**解决方法**：
- 查看右上角标签，确认EA在运行
- 降低`ADX_Threshold`（如改为20）
- 查看Journal是否有错误
- 重新编译EA并刷新图表

---

### Q2: 信号太多/太少怎么办？

**太多信号**（每小时多个）：
```
提高 ADX_Threshold: 25 → 30
增大 TrendMA_Fast: 21 → 30
增大 TrendMA_Slow: 50 → 60
```

**太少信号**（几天无信号）：
```
降低 ADX_Threshold: 25 → 20
减小 TrendMA_Fast: 21 → 15
减小 TrendMA_Slow: 50 → 40
```

---

### Q3: Demo模式可以测试金字塔加仓吗？

**不能**。Demo模式只显示初始入场信号，不会模拟持仓和加仓。

**测试完整金字塔逻辑**，请使用：
1. **策略测试器回测**（推荐）- 可以看到完整的金字塔构建
2. **小资金实盘**（关闭Demo模式）- 真实环境测试

---

### Q4: 如何保存Demo模式的测试结果？

**方法1: 截图保存**
- 图表右键 → 保存为图片

**方法2: 导出Journal日志**
- 终端 → 专家 → 右键 → 保存

**方法3: 手工记录**
```
时间: 2024-08-12 10:30
信号: LONG @ 1.09215
ADX: 28.5
后续走势: ✓ 上涨150点
评价: 信号准确
```

---

## 🚀 下一步

完成Demo模式测试后，您可以：

1. **✅ 优化参数** - 基于观察调整参数
2. **✅ 历史回测** - 在策略测试器中验证性能
3. **✅ 阅读文档** - 查看`PYRAMID_TREND_STRATEGY.md`了解详细逻辑
4. **✅ 小资金实盘** - 关闭Demo模式，真实交易测试

---

## 📚 相关文档

- **策略详解**: `docs/PYRAMID_TREND_STRATEGY.md`
- **快速开始**: `docs/PYRAMID_QUICK_START.md`
- **策略对比**: `docs/STRATEGY_COMPARISON.md`
- **过滤器说明**: `docs/TRADE_FILTERS.md`

---

**🎯 现在就开始吧！启用Demo模式，观察实时行情中的策略表现！**

